<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡πâ‡∏≤‡∏ô‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</title>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        /* CSS ‡πÄ‡∏î‡∏¥‡∏° */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Kanit', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            backdrop-filter: blur(10px);
            position: relative; /* ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤ */
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .nav-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .nav-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
            backdrop-filter: blur(5px);
        }

        .nav-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .nav-btn.active {
            background: rgba(255, 255, 255, 0.4);
            transform: scale(1.05);
        }

        .products-grid, .categories-grid { /* ‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏ä‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏Ñ‡∏π‡πà */
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); /* ‡∏•‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á 3x3 ‡∏´‡∏£‡∏∑‡∏≠ 4x4 */
            gap: 25px;
            margin-bottom: 30px;
        }
        
        .product-card, .category-card { /* ‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏ä‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏Ñ‡∏π‡πà */
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            display: flex;
            flex-direction: column;
        }

        .product-card:hover, .category-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 25px 50px rgba(0,0,0,0.2);
        }

        /* ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°‡∏à‡∏±‡∏ï‡∏∏‡∏£‡∏±‡∏™ */
        .product-image, .category-image {
            width: 100%;
            height: 250px; /* ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏Ç‡∏≠‡∏á card */
            object-fit: cover; /* ‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô */
            transition: transform 0.3s ease;
            display: block; /* ‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û */
        }

        .product-card:hover .product-image, .category-card:hover .category-image {
            transform: scale(1.05);
        }

        .product-info, .category-info {
            padding: 20px;
            flex-grow: 1; /* ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏Ç‡∏¢‡∏≤‡∏¢‡πÄ‡∏ï‡πá‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà */
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .product-name, .category-name {
            font-size: 1.3em;
            font-weight: 600;
            color: #333;
            margin-bottom: 10px;
            text-align: center; /* ‡∏à‡∏±‡∏î‡∏Å‡∏•‡∏≤‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà */
        }

        .product-price {
            font-size: 1.5em;
            color: #e74c3c;
            font-weight: 700;
            margin-bottom: 15px;
        }

        .product-details {
            color: #666;
            margin-bottom: 15px;
            font-size: 0.9em;
        }

        .buy-btn, .add-to-cart-btn { /* ‡πÅ‡∏¢‡∏Å‡∏õ‡∏∏‡πà‡∏°‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡πÅ‡∏•‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤ */
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            width: 100%;
            transition: all 0.3s ease;
            margin-top: auto; /* ‡∏à‡∏±‡∏î‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏õ‡∏∏‡πà‡∏°‡πÑ‡∏ß‡πâ‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡πÄ‡∏™‡∏°‡∏≠ */
        }

        .buy-btn:hover, .add-to-cart-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            backdrop-filter: blur(5px);
            overflow-y: auto;
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 30px;
            border-radius: 20px;
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .close-btn {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 30px;
            color: #999;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .close-btn:hover {
            color: #333;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #333;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .quantity-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .quantity-btn {
            background: #667eea;
            color: white;
            border: none;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 18px;
            font-weight: bold;
            transition: background 0.3s ease;
        }

        .quantity-btn:hover {
            background: #764ba2;
        }

        .quantity-input {
            width: 80px;
            text-align: center;
        }

        .order-summary, .cart-summary { /* ‡πÉ‡∏ä‡πâ‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô */
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
        }

        .total-price {
            font-size: 1.5em;
            font-weight: 700;
            color: #e74c3c;
            text-align: center;
            margin: 15px 0;
        }

        .submit-btn, .checkout-btn { /* ‡∏õ‡∏∏‡πà‡∏°‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡πÅ‡∏•‡∏∞ Checkout */
            background: linear-gradient(45deg, #28a745, #20c997);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 18px;
            font-weight: 600;
            width: 100%;
            transition: all 0.3s ease;
        }

        .submit-btn:hover, .checkout-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(40, 167, 69, 0.3);
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .success-message {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 1px solid #c3e6cb;
        }

        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 1px solid #f5c6cb;
        }

        /* Admin Panel Styles */
        #admin-panel {
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
        }

        #admin-panel h2 {
            color: #333;
            margin-bottom: 20px;
            text-align: center;
        }

        .admin-section {
            margin-bottom: 30px;
            padding: 20px;
            background: #f0f0f0;
            border-radius: 15px;
        }

        .admin-section h3 {
            color: #555;
            margin-bottom: 15px;
        }

        .admin-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        .admin-table th, .admin-table td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: left;
            vertical-align: top;
        }

        .admin-table th {
            background-color: #eee;
            font-weight: 600;
            color: #333;
        }

        .admin-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        .admin-table button {
            padding: 8px 12px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-right: 5px;
            font-size: 0.9em;
            transition: background 0.2s ease;
        }

        .admin-table .edit-btn {
            background-color: #007bff;
            color: white;
        }
        .admin-table .edit-btn:hover { background-color: #0056b3; }

        .admin-table .delete-btn {
            background-color: #dc3545;
            color: white;
        }
        .admin-table .delete-btn:hover { background-color: #c82333; }

        .admin-table .update-status-btn {
            background-color: #ffc107;
            color: #333;
        }
        .admin-table .update-status-btn:hover { background-color: #e0a800; }

        .add-product-form, .edit-product-form {
            background: #fff;
            padding: 25px;
            border-radius: 10px;
            margin-top: 20px;
            border: 1px solid #eee;
        }
        .add-product-form h3, .edit-product-form h3 {
            margin-bottom: 20px;
            color: #333;
        }

        .admin-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        /* Cart Icon */
        .cart-icon {
            position: absolute;
            top: 20px;
            right: 20px;
            background: white;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            transition: transform 0.2s ease;
        }

        .cart-icon:hover {
            transform: scale(1.1);
        }

        .cart-icon img {
            width: 28px;
            height: 28px;
        }

        .cart-count {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #e74c3c;
            color: white;
            border-radius: 50%;
            padding: 5px 8px;
            font-size: 0.8em;
            font-weight: bold;
            line-height: 1;
        }

        /* Cart Modal */
        #cartModal .cart-items-list {
            list-style: none;
            padding: 0;
            margin-bottom: 20px;
            border-top: 1px solid #eee;
        }

        #cartModal .cart-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px 0;
            border-bottom: 1px solid #eee;
        }

        #cartModal .cart-item-info {
            flex-grow: 1;
        }

        #cartModal .cart-item-name {
            font-weight: bold;
            color: #333;
        }

        #cartModal .cart-item-price {
            font-size: 0.9em;
            color: #666;
        }

        #cartModal .cart-item-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        #cartModal .cart-item-quantity-input {
            width: 50px;
            text-align: center;
            padding: 5px;
            border-radius: 5px;
            border: 1px solid #ddd;
        }

        #cartModal .remove-item-btn {
            background-color: #dc3545;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 5px 10px;
            cursor: pointer;
            font-size: 0.8em;
        }

        #cartModal .empty-cart-message {
            text-align: center;
            color: #666;
            margin: 20px 0;
        }

        /* Category Filter */
        .category-filter {
            text-align: center;
            margin-bottom: 30px;
        }

        .category-filter-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 15px;
            transition: all 0.3s ease;
            margin: 5px;
            backdrop-filter: blur(5px);
        }

        .category-filter-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .category-filter-btn.active {
            background: rgba(255, 255, 255, 0.4);
            transform: scale(1.05);
        }


        /* Media Queries */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2em;
            }

            .nav-buttons {
                flex-direction: column;
                align-items: center;
            }

            .products-grid, .categories-grid {
                grid-template-columns: 1fr;
            }

            .modal-content {
                width: 95%;
                padding: 20px;
            }

            .admin-table th, .admin-table td {
                padding: 8px;
                font-size: 0.9em;
            }
            .admin-table button {
                padding: 6px 10px;
            }
            .cart-icon {
                width: 45px;
                height: 45px;
                top: 15px;
                right: 15px;
            }
            .cart-icon img {
                width: 24px;
                height: 24px;
            }
            .cart-count {
                padding: 3px 6px;
                font-size: 0.7em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üõçÔ∏è ‡∏£‡πâ‡∏≤‡∏ô‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</h1>
            <p>‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏î‡∏µ ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏¢‡πà‡∏≠‡∏°‡πÄ‡∏¢‡∏≤ ‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡∏ü‡∏£‡∏µ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏ó‡∏¢</p>
            <div class="cart-icon" onclick="openCartModal()">
                <img src="https://img.icons8.com/ios-filled/50/shopping-cart.png" alt="Cart">
                <span class="cart-count" id="cartCount">0</span>
            </div>
        </div>

        <div class="nav-buttons">
            <button class="nav-btn active" id="categoriesNavBtn" onclick="showSection('categories-section')">üè† ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</button>
            <button class="nav-btn" id="orderStatusNavBtn" onclick="showSection('order-status-section')">üìã ‡πÄ‡∏ä‡πá‡∏Ñ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</button>
            <button class="nav-btn" id="contactNavBtn" onclick="showSection('contact-section')">üìû ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</button>
            <button class="nav-btn" id="adminNavBtn" onclick="showSection('admin-section')">‚öôÔ∏è ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</button>
        </div>

        <div id="categories-section" class="content-section">
            <h2 style="color: white; text-align: center; margin-bottom: 20px;">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h2>
            <div class="categories-grid" id="categories-grid">
                </div>
            <div id="noCategoriesMessage" style="text-align: center; color: white; display: none;">
                ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡πÉ‡∏ô‡∏Ç‡∏ì‡∏∞‡∏ô‡∏µ‡πâ
            </div>
        </div>

        <div id="products-section" class="content-section" style="display: none;">
            <div class="category-filter" id="categoryFilter">
                <button class="category-filter-btn active" onclick="loadProducts('All')">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
                </div>
            <div class="products-grid" id="products-grid">
                </div>
            <div id="noProductsMessage" style="text-align: center; color: white; display: none;">
                ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏ô‡∏µ‡πâ
            </div>
        </div>

        <div id="order-status-section" class="content-section" style="display: none;">
            <div style="background: rgba(255, 255, 255, 0.95); padding: 30px; border-radius: 20px; text-align: center;">
                <h2 style="color: #333; margin-bottom: 20px;">üîç ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</h2>
                <div class="form-group">
                    <input type="text" id="orderIdInput" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠" style="max-width: 300px; margin: 0 auto;">
                </div>
                <button onclick="checkOrderStatus()" class="submit-btn" style="max-width: 200px;">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</button>
                <div id="orderStatusResult" style="margin-top: 20px;"></div>
                <div class="loading" id="orderStatusLoading">
                    <div class="spinner"></div>
                    <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞...</p>
                </div>
            </div>
        </div>

        <div id="contact-section" class="content-section" style="display: none;">
            <div style="background: rgba(255, 255, 255, 0.95); padding: 30px; border-radius: 20px; text-align: center;">
                <h2 style="color: #333; margin-bottom: 20px;">üìû ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤</h2>
                <div style="max-width: 400px; margin: 0 auto; text-align: left;">
                    <p style="margin-bottom: 15px;"><strong>üì± ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£:</strong> 02-123-4567</p>
                    <p style="margin-bottom: 15px;"><strong>üìß ‡∏≠‡∏µ‡πÄ‡∏°‡∏•:</strong> info@shirtshop.com</p>
                    <p style="margin-bottom: 15px;"><strong>üí¨ Line ID:</strong> @shirtshop</p>
                    <p style="margin-bottom: 15px;"><strong>üïí ‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏≥‡∏Å‡∏≤‡∏£:</strong> ‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå-‡∏®‡∏∏‡∏Å‡∏£‡πå 9:00-18:00</p>
                    <p style="margin-bottom: 15px;"><strong>üì¶ ‡∏à‡∏±‡∏î‡∏™‡πà‡∏á:</strong> ‡πÉ‡∏ä‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ Kerry Express</p>
                </div>
            </div>
        </div>

        <div id="admin-section" class="content-section" style="display: none;">
            <div id="admin-login-area">
                <div style="background: rgba(255, 255, 255, 0.95); padding: 30px; border-radius: 20px; text-align: center; max-width: 400px; margin: 0 auto;">
                    <h2 style="color: #333; margin-bottom: 20px;">üîë ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•</h2>
                    <div class="form-group">
                        <label for="adminUsername">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ:</label>
                        <input type="text" id="adminUsername" placeholder="Useradmin" required>
                    </div>
                    <div class="form-group">
                        <label for="adminPassword">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô:</label>
                        <input type="password" id="adminPassword" placeholder="Password" required>
                    </div>
                    <button onclick="adminLogin()" class="submit-btn">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
                    <div id="adminLoginMessage" style="margin-top: 15px;"></div>
                    <div class="loading" id="adminLoginLoading">
                        <div class="spinner"></div>
                        <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö...</p>
                    </div>
                </div>
            </div>

            <div id="admin-panel" style="display: none;">
                <h2>‚öôÔ∏è ‡πÅ‡∏ú‡∏á‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•</h2>
                <button onclick="adminLogout()" class="nav-btn" style="margin-bottom: 20px;">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>

                <div class="admin-section">
                    <h3>‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h3>
                    <button onclick="showAddProductForm()" class="submit-btn" style="margin-bottom: 20px; max-width: 200px;">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà</button>
                    <table class="admin-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>‡∏ä‡∏∑‡πà‡∏≠</th>
                                <th>‡∏£‡∏≤‡∏Ñ‡∏≤</th>
                                <th>‡∏™‡∏ï‡πá‡∏≠‡∏Å</th>
                                <th>‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</th>
                                <th>‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                            </tr>
                        </thead>
                        <tbody id="adminProductTableBody">
                            </tbody>
                    </table>
                    <div id="noAdminProductsMessage" style="text-align: center; margin-top: 15px; display: none;">
                        ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤.
                    </div>
                </div>

                <div id="addProductForm" class="add-product-form" style="display: none;">
                    <h3>‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà</h3>
                    <form id="productEntryForm">
                        <input type="hidden" id="productId">
                        <div class="form-group">
                            <label for="productName">‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤:</label>
                            <input type="text" id="productName" required>
                        </div>
                        <div class="form-group">
                            <label for="productPrice">‡∏£‡∏≤‡∏Ñ‡∏≤:</label>
                            <input type="number" id="productPrice" step="0.01" required>
                        </div>
                        <div class="form-group">
                            <label for="productImage">URL ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û:</label>
                            <input type="url" id="productImage" placeholder="https://via.placeholder.com/300" required>
                        </div>
                        <div class="form-group">
                            <label for="productSize">‡∏Ç‡∏ô‡∏≤‡∏î (‡∏Ñ‡∏±‡πà‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏≠‡∏°‡∏°‡∏≤ ‡πÄ‡∏ä‡πà‡∏ô S,M,L):</label>
                            <input type="text" id="productSize" required>
                        </div>
                        <div class="form-group">
                            <label for="productColor">‡∏™‡∏µ:</label>
                            <input type="text" id="productColor" required>
                        </div>
                        <div class="form-group">
                            <label for="productStock">‡∏™‡∏ï‡πá‡∏≠‡∏Å:</label>
                            <input type="number" id="productStock" required>
                        </div>
                        <div class="form-group">
                            <label for="productDescription">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î:</label>
                            <textarea id="productDescription" rows="3"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="productCategory">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà:</label>
                            <input type="text" id="productCategory" required placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏¢‡∏∑‡∏î, ‡∏Å‡∏≤‡∏á‡πÄ‡∏Å‡∏á">
                        </div>
                        <button type="submit" class="submit-btn" id="submitProductBtn">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</button>
                        <button type="button" class="nav-btn" onclick="cancelProductEdit()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                    </form>
                    <div class="loading" id="productFormLoading">
                        <div class="spinner"></div>
                        <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£...</p>
                    </div>
                    <div id="productFormMessage" style="margin-top: 15px;"></div>
                </div>

                <div class="admin-section" style="margin-top: 30px;">
                    <h3>‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h3>
                    <table class="admin-table">
                        <thead>
                            <tr>
                                <th>Order ID</th>
                                <th>‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</th>
                                <th>‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</th>
                                <th>‡∏£‡∏ß‡∏°</th>
                                <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                                <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                                <th>‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                            </tr>
                        </thead>
                        <tbody id="adminOrderTableBody">
                            </tbody>
                    </table>
                    <div id="noAdminOrdersMessage" style="text-align: center; margin-top: 15px; display: none;">
                        ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠.
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="productDetailsModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeProductDetailsModal()">&times;</span>
            <h2 id="modalProductName" style="color: #333; margin-bottom: 20px;"></h2>
            <img id="modalProductImage" src="" alt="" class="product-image" style="margin-bottom: 15px; border-radius: 10px;">
            <p id="modalProductDescription" style="color: #666; margin-bottom: 10px;"></p>
            <p id="modalProductStock" style="font-weight: bold; margin-bottom: 15px;"></p>

            <div class="form-group">
                <label>‡∏Ç‡∏ô‡∏≤‡∏î:</label>
                <select id="modalProductSize">
                    </select>
            </div>
            <div class="form-group">
                <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô:</label>
                <div class="quantity-controls">
                    <button class="quantity-btn" onclick="changeModalQuantity(-1)">-</button>
                    <input type="number" id="modalQuantity" class="quantity-input" value="1" min="1">
                    <button class="quantity-btn" onclick="changeModalQuantity(1)">+</button>
                </div>
            </div>
            <div class="total-price" id="modalProductPriceTotal">‡∏ø0</div>
            <button class="add-to-cart-btn" onclick="addToCart()">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤</button>
            <div id="productDetailsMessage" style="margin-top: 15px;"></div>
        </div>
    </div>

    <div id="cartModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeCartModal()">&times;</span>
            <h2 style="color: #333; margin-bottom: 20px;">üõí ‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</h2>
            <ul class="cart-items-list" id="cartItemsList">
                </ul>
            <div id="emptyCartMessage" class="empty-cart-message" style="display: none;">‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏õ‡∏•‡πà‡∏≤</div>
            <div class="total-price" id="cartTotalPrice">‡∏£‡∏ß‡∏°: ‡∏ø0</div>
            <button class="submit-btn" onclick="openCheckoutModal()" id="checkoutButton">‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</button>
            <button class="nav-btn" style="margin-top: 10px;" onclick="clearCart()">‡∏•‡πâ‡∏≤‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤</button>
        </div>
    </div>

    <div id="checkoutModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeCheckoutModal()">&times;</span>
            <h2 style="color: #333; margin-bottom: 20px;">üì¶ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏™‡πà‡∏á</h2>

            <div class="order-summary">
                <h3 style="color: #333;">‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</h3>
                <ul class="cart-items-list" id="checkoutItemsList">
                    </ul>
                <div class="total-price" id="checkoutTotalPrice">‡∏£‡∏ß‡∏°: ‡∏ø0</div>
            </div>

            <form id="checkoutForm">
                <div class="form-group">
                    <label>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•:</label>
                    <input type="text" id="customerName" required>
                </div>
                <div class="form-group">
                    <label>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå:</label>
                    <input type="tel" id="phone" pattern="[0-9]{10}" title="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå 10 ‡∏´‡∏•‡∏±‡∏Å" required>
                </div>
                <div class="form-group">
                    <label>‡∏≠‡∏µ‡πÄ‡∏°‡∏•:</label>
                    <input type="email" id="email" required>
                </div>
                <div class="form-group">
                    <label>‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏±‡∏î‡∏™‡πà‡∏á:</label>
                    <textarea id="address" rows="3" required></textarea>
                </div>
                <div class="form-group">
                    <label>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</label>
                    <textarea id="note" rows="2" placeholder="‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° (‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô)"></textarea>
                </div>

                <button type="submit" class="checkout-btn">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</button>
            </form>

            <div class="loading" id="checkoutLoading">
                <div class="spinner"></div>
                <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠...</p>
            </div>
             <div id="checkoutFormMessage" style="margin-top: 15px;"></div>
        </div>
    </div>


    <script>
        // *** ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å: ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ñ‡πà‡∏≤‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô URL ‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì Deploy Google Apps Script ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì ***
        const API_URL = 'https://script.google.com/macros/s/AKfycbz7dG_-XLNXF5PWV5pPKdf56bT-LVfPUDBx_gvNLTj8IdE4SQ2crLEHwv1aINozJmKJ/exec';

        let products = []; // ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
        let categories = []; // ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
        let cartItems = []; // ‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
        let isAdminLoggedIn = false;
        let adminToken = null;

        // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
        window.onload = function() {
            loadCategories(); // ‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏Å‡πà‡∏≠‡∏ô
            loadCartFromLocalStorage(); // ‡πÇ‡∏´‡∏•‡∏î‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏à‡∏≤‡∏Å Local Storage
            updateCartCount(); // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô Admin ‡∏à‡∏≤‡∏Å Local Storage
            const savedAdminToken = localStorage.getItem('adminToken');
            if (savedAdminToken && savedAdminToken.startsWith('admin_token_')) {
                isAdminLoggedIn = true;
                adminToken = savedAdminToken;
                // ‡∏´‡∏≤‡∏Å‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß ‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏ô‡πâ‡∏≤ Admin Panel ‡πÄ‡∏•‡∏¢ (‡∏´‡∏≤‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏Å‡∏î‡πÅ‡∏ó‡πá‡∏ö Admin)
            }
            showSection('categories-section'); // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà
        };

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô Section
        function showSection(sectionId, force = false) {
            const sections = document.querySelectorAll('.content-section');
            sections.forEach(section => {
                section.style.display = 'none';
            });
            document.getElementById(sectionId).style.display = 'block';

            const navBtns = document.querySelectorAll('.nav-btn');
            navBtns.forEach(btn => {
                btn.classList.remove('active');
            });
            document.getElementById(sectionId.replace('-section', 'NavBtn')).classList.add('active');

            if (sectionId === 'admin-section' && !isAdminLoggedIn && !force) {
                document.getElementById('admin-login-area').style.display = 'block';
                document.getElementById('admin-panel').style.display = 'none';
            } else if (sectionId === 'admin-section' && isAdminLoggedIn) {
                document.getElementById('admin-login-area').style.display = 'none';
                document.getElementById('admin-panel').style.display = 'block';
                loadAdminData(); // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Admin
            } else if (sectionId === 'products-section') {
                // ‡∏´‡∏≤‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÅ‡∏™‡∏î‡∏á Products section ‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ categories ‡∏ñ‡∏π‡∏Å‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏•‡πâ‡∏ß
                // ‡πÅ‡∏•‡∏∞‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà
                // ‡πÅ‡∏ï‡πà‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å‡∏Ñ‡∏∑‡∏≠ Categories ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏Ç‡πâ‡∏≤ Product Section, ‡πÉ‡∏´‡πâ‡πÇ‡∏´‡∏•‡∏î All Products ‡πÄ‡∏™‡∏°‡∏≠
                 loadProducts('All');
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà
        async function loadCategories() {
            document.getElementById('categories-grid').innerHTML = '';
            document.getElementById('noCategoriesMessage').style.display = 'none';

            try {
                const response = await fetch(`${API_URL}?action=getCategories`);
                const data = await response.json();

                if (data.success) {
                    categories = data.categories;
                    displayCategories();
                    updateCategoryFilterButtons(); // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏õ‡∏∏‡πà‡∏° Filter
                } else {
                    console.error('Error loading categories:', data.error);
                    document.getElementById('categories-grid').innerHTML = `<p class="error-message">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà: ${data.error}</p>`;
                }
            } catch (error) {
                console.error('Network or parsing error:', error);
                document.getElementById('categories-grid').innerHTML = `<p class="error-message">‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡πÑ‡∏î‡πâ.</p>`;
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà
        function displayCategories() {
            const categoriesGrid = document.getElementById('categories-grid');
            categoriesGrid.innerHTML = '';

            if (categories.length === 0) {
                document.getElementById('noCategoriesMessage').style.display = 'block';
                return;
            }
            document.getElementById('noCategoriesMessage').style.display = 'none';

            // ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà (‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏à‡∏£‡∏¥‡∏á‡πÑ‡∏î‡πâ)
            const categoryImages = {
                '‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏¢‡∏∑‡∏î': 'https://via.placeholder.com/300/a8dadc/1d3557?text=T-Shirt',
                '‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡πÇ‡∏õ‡πÇ‡∏•': 'https://via.placeholder.com/300/457b9d/f1faee?text=Polo+Shirt',
                '‡∏Å‡∏≤‡∏á‡πÄ‡∏Å‡∏á': 'https://via.placeholder.com/300/1d3557/a8dadc?text=Pants',
                // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà
            };

            categories.forEach(category => {
                const categoryCard = document.createElement('div');
                categoryCard.classList.add('category-card');
                const categoryImageUrl = categoryImages[category] || 'https://via.placeholder.com/300/cccccc/000000?text=Category';
                categoryCard.innerHTML = `
                    <img src="${categoryImageUrl}" alt="${category}" class="category-image">
                    <div class="category-info">
                        <h3 class="category-name">${category}</h3>
                        <button class="buy-btn" onclick="showProductsByCategory('${category}')">‡∏î‡∏π‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</button>
                    </div>
                `;
                categoriesGrid.appendChild(categoryCard);
            });
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏õ‡∏∏‡πà‡∏°‡∏ü‡∏¥‡∏•‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà
        function updateCategoryFilterButtons() {
            const categoryFilter = document.getElementById('categoryFilter');
            // ‡∏•‡∏ö‡∏õ‡∏∏‡πà‡∏°‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡πÄ‡∏Å‡πà‡∏≤‡∏≠‡∏≠‡∏Å ‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô‡∏õ‡∏∏‡πà‡∏° "‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î"
            const oldCategoryButtons = categoryFilter.querySelectorAll('.category-filter-btn:not(:first-child)');
            oldCategoryButtons.forEach(btn => btn.remove());

            categories.forEach(category => {
                const btn = document.createElement('button');
                btn.classList.add('category-filter-btn');
                btn.innerText = category;
                btn.onclick = () => loadProducts(category);
                categoryFilter.appendChild(btn);
            });
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ï‡∏≤‡∏°‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà
        function showProductsByCategory(category) {
            showSection('products-section'); // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ Products
            loadProducts(category); // ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏ô‡∏±‡πâ‡∏ô
        }


        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
        async function loadProducts(category = 'All') {
            document.getElementById('products-grid').innerHTML = '';
            showLoading(false, 'products-section');
            document.getElementById('noProductsMessage').style.display = 'none';

            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï Active State ‡∏Ç‡∏≠‡∏á‡∏õ‡∏∏‡πà‡∏° Filter
            document.querySelectorAll('.category-filter-btn').forEach(btn => {
                if (btn.innerText.toLowerCase() === category.toLowerCase() || (category === 'All' && btn.innerText === '‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î')) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });

            let url = `${API_URL}?action=getProducts`;
            if (category !== 'All') {
                url += `&category=${encodeURIComponent(category)}`;
            }

            try {
                const response = await fetch(url);
                const data = await response.json();

                if (data.success) {
                    products = data.products; // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï global products list
                    displayProducts();
                } else {
                    console.error('Error loading products:', data.error);
                    document.getElementById('products-grid').innerHTML = `<p class="error-message">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤: ${data.error}</p>`;
                }
            } catch (error) {
                console.error('Network or parsing error:', error);
                document.getElementById('products-grid').innerHTML = `<p class="error-message">‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡πÑ‡∏î‡πâ. ‡πÇ‡∏õ‡∏£‡∏î‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏≠‡∏¥‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ï.</p>`;
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
        function displayProducts() {
            const productsGrid = document.getElementById('products-grid');
            productsGrid.innerHTML = '';

            if (products.length === 0) {
                document.getElementById('noProductsMessage').style.display = 'block';
                return;
            }
            document.getElementById('noProductsMessage').style.display = 'none';

            products.forEach(product => {
                const productCard = document.createElement('div');
                productCard.classList.add('product-card');
                productCard.innerHTML = `
                    <img src="${product.image}" alt="${product.name}" class="product-image">
                    <div class="product-info">
                        <h3 class="product-name">${product.name}</h3>
                        <p class="product-details">‡∏Ç‡∏ô‡∏≤‡∏î: ${product.size}</p>
                        <p class="product-details">‡∏™‡∏µ: ${product.color}</p>
                        <p class="product-details">‡∏™‡∏ï‡πá‡∏≠‡∏Å: ${product.stock}</p>
                        <p class="product-details">${product.description}</p>
                        <div class="product-price">‡∏ø${parseFloat(product.price).toLocaleString('th-TH', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                        <button class="add-to-cart-btn" onclick="openProductDetailsModal(${product.id})">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤</button>
                    </div>
                `;
                productsGrid.appendChild(productCard);
            });
        }

        // === Cart System ===

        let currentProductForModal = null; // ‡πÄ‡∏Å‡πá‡∏ö product ‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö modal

        function openProductDetailsModal(productId) {
            currentProductForModal = products.find(p => p.id == productId);
            if (currentProductForModal) {
                document.getElementById('modalProductName').innerText = currentProductForModal.name;
                document.getElementById('modalProductImage').src = currentProductForModal.image;
                document.getElementById('modalProductDescription').innerText = currentProductForModal.description;
                document.getElementById('modalProductStock').innerText = `‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÉ‡∏ô‡∏™‡∏ï‡πá‡∏≠‡∏Å: ${currentProductForModal.stock} ‡∏ä‡∏¥‡πâ‡∏ô`;
                document.getElementById('modalQuantity').value = 1;

                const sizeSelect = document.getElementById('modalProductSize');
                sizeSelect.innerHTML = '';
                const sizes = currentProductForModal.size.split(',').map(s => s.trim());
                sizes.forEach(size => {
                    const option = document.createElement('option');
                    option.value = size;
                    option.innerText = size;
                    sizeSelect.appendChild(option);
                });

                updateModalTotalPrice();
                document.getElementById('productDetailsModal').style.display = 'block';
                document.getElementById('productDetailsMessage').innerHTML = ''; // Clear messages
            } else {
                alert('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤');
            }
        }

        function closeProductDetailsModal() {
            document.getElementById('productDetailsModal').style.display = 'none';
        }

        function changeModalQuantity(delta) {
            let quantityInput = document.getElementById('modalQuantity');
            let currentQuantity = parseInt(quantityInput.value);
            let newQuantity = currentQuantity + delta;

            if (newQuantity < 1) newQuantity = 1;
            if (currentProductForModal && newQuantity > parseInt(currentProductForModal.stock)) {
                alert(`‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏°‡∏µ‡πÄ‡∏û‡∏µ‡∏¢‡∏á ${currentProductForModal.stock} ‡∏ä‡∏¥‡πâ‡∏ô`);
                newQuantity = parseInt(currentProductForModal.stock);
            }

            quantityInput.value = newQuantity;
            updateModalTotalPrice();
        }

        function updateModalTotalPrice() {
            const quantity = parseInt(document.getElementById('modalQuantity').value);
            const price = parseFloat(currentProductForModal.price);
            const total = quantity * price;
            document.getElementById('modalProductPriceTotal').innerText = `‡∏ø${total.toLocaleString('th-TH', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
        }

        function addToCart() {
            const quantity = parseInt(document.getElementById('modalQuantity').value);
            const selectedSize = document.getElementById('modalProductSize').value;

            if (quantity <= 0 || !selectedSize) {
                displayMessage('error', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏•‡∏∞‡∏Ç‡∏ô‡∏≤‡∏î‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á', 'productDetailsMessage');
                return;
            }
            if (quantity > parseInt(currentProductForModal.stock)) {
                displayMessage('error', `‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏°‡∏µ‡πÄ‡∏û‡∏µ‡∏¢‡∏á ${currentProductForModal.stock} ‡∏ä‡∏¥‡πâ‡∏ô`, 'productDetailsMessage');
                return;
            }

            // Check if item with same ID and size already in cart
            const existingItemIndex = cartItems.findIndex(item =>
                item.id === currentProductForModal.id && item.size === selectedSize
            );

            if (existingItemIndex > -1) {
                // Update quantity if exists
                const existingItem = cartItems[existingItemIndex];
                if (existingItem.quantity + quantity > parseInt(currentProductForModal.stock)) {
                    displayMessage('error', `‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ, ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô‡∏™‡∏ï‡πá‡∏≠‡∏Å‡πÑ‡∏°‡πà‡∏û‡∏≠‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏ß‡∏° ${existingItem.quantity + quantity} ‡∏ä‡∏¥‡πâ‡∏ô`, 'productDetailsMessage');
                    return;
                }
                existingItem.quantity += quantity;
            } else {
                // Add new item to cart
                cartItems.push({
                    id: currentProductForModal.id,
                    name: currentProductForModal.name,
                    price: parseFloat(currentProductForModal.price),
                    image: currentProductForModal.image,
                    size: selectedSize,
                    quantity: quantity,
                    stock: parseInt(currentProductForModal.stock) // ‡πÄ‡∏Å‡πá‡∏ö stock ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ä‡πá‡∏Ñ‡∏ï‡∏≠‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°
                });
            }

            saveCartToLocalStorage();
            updateCartCount();
            displayMessage('success', `${currentProductForModal.name} (‡∏Ç‡∏ô‡∏≤‡∏î ${selectedSize}, ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô ${quantity}) ‡∏ñ‡∏π‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡πÅ‡∏•‡πâ‡∏ß!`, 'productDetailsMessage');
            setTimeout(closeProductDetailsModal, 1500); // ‡∏õ‡∏¥‡∏î modal ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å 1.5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
        }

        function saveCartToLocalStorage() {
            localStorage.setItem('cartItems', JSON.stringify(cartItems));
        }

        function loadCartFromLocalStorage() {
            const savedCart = localStorage.getItem('cartItems');
            if (savedCart) {
                cartItems = JSON.parse(savedCart);
            }
        }

        function updateCartCount() {
            const totalItems = cartItems.reduce((sum, item) => sum + item.quantity, 0);
            document.getElementById('cartCount').innerText = totalItems;
        }

        function openCartModal() {
            displayCartItems();
            document.getElementById('cartModal').style.display = 'block';
        }

        function closeCartModal() {
            document.getElementById('cartModal').style.display = 'none';
        }

        function displayCartItems() {
            const cartList = document.getElementById('cartItemsList');
            cartList.innerHTML = '';
            let totalCartPrice = 0;

            if (cartItems.length === 0) {
                document.getElementById('emptyCartMessage').style.display = 'block';
                document.getElementById('checkoutButton').disabled = true;
            } else {
                document.getElementById('emptyCartMessage').style.display = 'none';
                document.getElementById('checkoutButton').disabled = false;

                cartItems.forEach((item, index) => {
                    const listItem = document.createElement('li');
                    listItem.classList.add('cart-item');
                    listItem.innerHTML = `
                        <div class="cart-item-info">
                            <div class="cart-item-name">${item.name} (‡∏Ç‡∏ô‡∏≤‡∏î: ${item.size})</div>
                            <div class="cart-item-price">‡∏ø${item.price.toLocaleString('th-TH', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                        </div>
                        <div class="cart-item-controls">
                            <button class="quantity-btn" onclick="changeCartItemQuantity(${index}, -1)">-</button>
                            <input type="number" value="${item.quantity}" min="1" class="cart-item-quantity-input" onchange="updateCartItemQuantityManual(${index}, this.value)">
                            <button class="quantity-btn" onclick="changeCartItemQuantity(${index}, 1)">+</button>
                            <button class="remove-item-btn" onclick="removeCartItem(${index})">‡∏•‡∏ö</button>
                        </div>
                    `;
                    cartList.appendChild(listItem);
                    totalCartPrice += item.quantity * item.price;
                });
            }
            document.getElementById('cartTotalPrice').innerText = `‡∏£‡∏ß‡∏°: ‡∏ø${totalCartPrice.toLocaleString('th-TH', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
        }

        function changeCartItemQuantity(index, delta) {
            let item = cartItems[index];
            let newQuantity = item.quantity + delta;

            if (newQuantity < 1) newQuantity = 1;
            if (newQuantity > item.stock) { // ‡πÉ‡∏ä‡πâ stock ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡πÉ‡∏ô item
                alert(`‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ${item.name} (‡∏Ç‡∏ô‡∏≤‡∏î ${item.size}) ‡∏°‡∏µ‡πÉ‡∏ô‡∏™‡∏ï‡πá‡∏≠‡∏Å‡πÄ‡∏û‡∏µ‡∏¢‡∏á ${item.stock} ‡∏ä‡∏¥‡πâ‡∏ô`);
                newQuantity = item.stock;
            }

            item.quantity = newQuantity;
            saveCartToLocalStorage();
            updateCartCount();
            displayCartItems();
        }

        function updateCartItemQuantityManual(index, value) {
            let item = cartItems[index];
            let newQuantity = parseInt(value);

            if (isNaN(newQuantity) || newQuantity < 1) newQuantity = 1;
            if (newQuantity > item.stock) {
                alert(`‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ${item.name} (‡∏Ç‡∏ô‡∏≤‡∏î ${item.size}) ‡∏°‡∏µ‡πÉ‡∏ô‡∏™‡∏ï‡πá‡∏≠‡∏Å‡πÄ‡∏û‡∏µ‡∏¢‡∏á ${item.stock} ‡∏ä‡∏¥‡πâ‡∏ô`);
                newQuantity = item.stock;
            }

            item.quantity = newQuantity;
            saveCartToLocalStorage();
            updateCartCount();
            displayCartItems();
        }

        function removeCartItem(index) {
            if (confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ä‡∏¥‡πâ‡∏ô‡∏ô‡∏µ‡πâ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                cartItems.splice(index, 1);
                saveCartToLocalStorage();
                updateCartCount();
                displayCartItems();
            }
        }

        function clearCart() {
            if (confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏≤‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                cartItems = [];
                saveCartToLocalStorage();
                updateCartCount();
                displayCartItems();
            }
        }

        function openCheckoutModal() {
            closeCartModal(); // ‡∏õ‡∏¥‡∏î‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤
            // ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏ô Checkout Modal
            const checkoutList = document.getElementById('checkoutItemsList');
            checkoutList.innerHTML = '';
            let totalCheckoutPrice = 0;

            cartItems.forEach(item => {
                const listItem = document.createElement('li');
                listItem.innerHTML = `
                    <div style="display: flex; justify-content: space-between;">
                        <span>${item.name} (‡∏Ç‡∏ô‡∏≤‡∏î: ${item.size}) x ${item.quantity}</span>
                        <span>‡∏ø${(item.quantity * item.price).toLocaleString('th-TH', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                    </div>
                `;
                checkoutList.appendChild(listItem);
                totalCheckoutPrice += item.quantity * item.price;
            });
            document.getElementById('checkoutTotalPrice').innerText = `‡∏£‡∏ß‡∏°: ‡∏ø${totalCheckoutPrice.toLocaleString('th-TH', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;

            document.getElementById('checkoutModal').style.display = 'block';
            document.getElementById('checkoutFormMessage').innerHTML = ''; // Clear messages
        }

        function closeCheckoutModal() {
            document.getElementById('checkoutModal').style.display = 'none';
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏à‡∏≤‡∏Å Checkout Modal
        document.getElementById('checkoutForm').addEventListener('submit', async function(event) {
            event.preventDefault();
            showLoading(true, 'checkout');
            document.getElementById('checkoutFormMessage').innerHTML = '';

            const customerName = document.getElementById('customerName').value;
            const phone = document.getElementById('phone').value;
            const email = document.getElementById('email').value;
            const address = document.getElementById('address').value;
            const totalAmount = parseFloat(document.getElementById('checkoutTotalPrice').innerText.replace('‡∏£‡∏ß‡∏°: ‡∏ø', '').replace(/,/g, ''));

            if (cartItems.length === 0) {
                displayMessage('error', '‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏õ‡∏•‡πà‡∏≤ ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡πÑ‡∏î‡πâ', 'checkoutFormMessage');
                showLoading(false, 'checkout');
                return;
            }

            const params = new URLSearchParams();
            params.append('action', 'createOrder');
            params.append('customerName', customerName);
            params.append('phone', phone);
            params.append('email', email);
            params.append('address', address);
            params.append('cartItems', JSON.stringify(cartItems)); // ‡∏™‡πà‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô JSON string
            params.append('total', totalAmount);

            try {
                const response = await fetch(`${API_URL}?${params.toString()}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    body: params.toString()
                });
                const data = await response.json();

                if (data.success) {
                    displayMessage('success', `‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏∑‡∏≠: ${data.orderId}`, 'checkoutFormMessage');
                    document.getElementById('checkoutForm').reset();
                    cartItems = []; // ‡∏•‡πâ‡∏≤‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤
                    saveCartToLocalStorage();
                    updateCartCount();
                    setTimeout(() => {
                        closeCheckoutModal();
                        loadProducts('All'); // ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏´‡∏°‡πà (‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
                    }, 2000);
                } else {
                    displayMessage('error', `‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠: ${data.error}`, 'checkoutFormMessage');
                }
            } catch (error) {
                console.error('Network or parsing error:', error);
                displayMessage('error', '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡πÑ‡∏î‡πâ. ‡πÇ‡∏õ‡∏£‡∏î‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏≠‡∏¥‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ï.', 'checkoutFormMessage');
            } finally {
                showLoading(false, 'checkout');
            }
        });


        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠
        async function checkOrderStatus() {
            const orderId = document.getElementById('orderIdInput').value.trim();
            const orderStatusResult = document.getElementById('orderStatusResult');
            orderStatusResult.innerHTML = '';
            document.getElementById('orderStatusLoading').style.display = 'block';

            if (!orderId) {
                displayMessage('error', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠', 'orderStatusResult');
                document.getElementById('orderStatusLoading').style.display = 'none';
                return;
            }

            try {
                const response = await fetch(`${API_URL}?action=getOrderById&orderId=${orderId}`);
                const data = await response.json();

                if (data.success && data.order) {
                    const order = data.order;
                    let itemsHtml = '';
                    // cartitemsjson ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å parse ‡πÄ‡∏õ‡πá‡∏ô array ‡∏Ç‡∏≠‡∏á object ‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏ô backend
                    if (Array.isArray(order.cartitemsjson)) {
                        order.cartitemsjson.forEach(item => {
                            itemsHtml += `<li>${item.name} (‡∏Ç‡∏ô‡∏≤‡∏î: ${item.size}, ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô: ${item.quantity}, ‡∏£‡∏≤‡∏Ñ‡∏≤: ${item.price} ‡∏ö‡∏≤‡∏ó)</li>`;
                        });
                    } else {
                        itemsHtml = '<li>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</li>';
                    }

                    orderStatusResult.innerHTML = `
                        <div class="success-message">
                            <h3>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ ${order.orderid}</h3>
                            <p><strong>‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤:</strong> ${order.customername}</p>
                            <p><strong>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå:</strong> ${order.phone}</p>
                            <p><strong>‡∏≠‡∏µ‡πÄ‡∏°‡∏•:</strong> ${order.email}</p>
                            <p><strong>‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà:</strong> ${order.address}</p>
                            <p><strong>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤:</strong></p>
                            <ul>${itemsHtml}</ul>
                            <p><strong>‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°:</strong> ‡∏ø${parseFloat(order.total).toLocaleString('th-TH', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</p>
                            <p><strong>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</strong> <strong style="color: ${getOrderStatusColor(order.status)};">${order.status}</strong></p>
                            <p><strong>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠:</strong> ${order.date}</p>
                        </div>
                    `;
                } else {
                    displayMessage('error', `‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç ${orderId}`, 'orderStatusResult');
                }
            } catch (error) {
                console.error('Network or parsing error:', error);
                displayMessage('error', '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡πÑ‡∏î‡πâ. ‡πÇ‡∏õ‡∏£‡∏î‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á.', 'orderStatusResult');
            } finally {
                document.getElementById('orderStatusLoading').style.display = 'none';
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á/‡∏ã‡πà‡∏≠‡∏ô Loading Spinner
        function showLoading(show, section = null) {
            if (section === 'productDetailsModal') {
                document.getElementById('productDetailsLoading').style.display = show ? 'block' : 'none';
                document.getElementById('productDetailsModal').querySelector('form').style.display = show ? 'none' : 'block';
            } else if (section === 'checkout') {
                document.getElementById('checkoutLoading').style.display = show ? 'block' : 'none';
                document.getElementById('checkoutForm').style.display = show ? 'none' : 'block';
            } else if (section === 'adminLogin') {
                document.getElementById('adminLoginLoading').style.display = show ? 'block' : 'none';
                document.getElementById('adminUsername').disabled = show;
                document.getElementById('adminPassword').disabled = show;
                document.querySelector('#admin-login-area button').disabled = show;
            } else if (section === 'productForm') {
                document.getElementById('productFormLoading').style.display = show ? 'block' : 'none';
                document.getElementById('productEntryForm').style.display = show ? 'none' : 'block';
            } else if (section === 'orderStatus') {
                document.getElementById('orderStatusLoading').style.display = show ? 'block' : 'none';
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à/‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î
        function displayMessage(type, message, elementId) {
            const messageElement = document.getElementById(elementId);
            messageElement.innerHTML = `<div class="${type}-message">${message}</div>`;
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Admin Login
        async function adminLogin() {
            const username = document.getElementById('adminUsername').value;
            const password = document.getElementById('adminPassword').value;
            document.getElementById('adminLoginMessage').innerHTML = '';
            showLoading(true, 'adminLogin');

            const params = new URLSearchParams();
            params.append('action', 'adminLogin');
            params.append('username', username);
            params.append('password', password);

            try {
                const response = await fetch(`${API_URL}?${params.toString()}`);
                const data = await response.json();

                if (data.success) {
                    isAdminLoggedIn = true;
                    adminToken = data.token;
                    localStorage.setItem('adminToken', adminToken);
                    displayMessage('success', '‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'adminLoginMessage');
                    setTimeout(() => {
                        showSection('admin-section', true); // ‡πÅ‡∏™‡∏î‡∏á Admin Panel
                    }, 500);
                } else {
                    displayMessage('error', data.message, 'adminLoginMessage');
                }
            } catch (error) {
                console.error('Login error:', error);
                displayMessage('error', '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠. ‡πÇ‡∏õ‡∏£‡∏î‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á.', 'adminLoginMessage');
            } finally {
                showLoading(false, 'adminLogin');
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Admin Logout
        function adminLogout() {
            isAdminLoggedIn = false;
            adminToken = null;
            localStorage.removeItem('adminToken');
            alert('‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
            showSection('admin-section');
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Admin (‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠)
        async function loadAdminData() {
            await loadAdminProducts();
            await loadAdminOrders();
        }

        // ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Admin
        async function loadAdminProducts() {
            const adminProductTableBody = document.getElementById('adminProductTableBody');
            adminProductTableBody.innerHTML = '<tr><td colspan="6" style="text-align: center;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤...</td></tr>';
            document.getElementById('noAdminProductsMessage').style.display = 'none';

            try {
                const response = await fetch(`${API_URL}?action=getProducts`);
                const data = await response.json();

                adminProductTableBody.innerHTML = '';

                if (data.success && data.products.length > 0) {
                    products = data.products; // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï products array ‡∏î‡πâ‡∏ß‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
                    products.forEach(product => {
                        const row = adminProductTableBody.insertRow();
                        row.innerHTML = `
                            <td>${product.id}</td>
                            <td>${product.name}</td>
                            <td>‡∏ø${parseFloat(product.price).toLocaleString('th-TH', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</td>
                            <td>${product.stock}</td>
                            <td>${product.category || '-'}</td>
                            <td class="admin-actions">
                                <button class="edit-btn" onclick="editProduct(${product.id})">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
                                <button class="delete-btn" onclick="deleteProduct(${product.id})">‡∏•‡∏ö</button>
                            </td>
                        `;
                    });
                } else if (data.success && data.products.length === 0) {
                    document.getElementById('noAdminProductsMessage').style.display = 'block';
                } else {
                    adminProductTableBody.innerHTML = `<tr><td colspan="6" class="error-message">Error: ${data.error}</td></tr>`;
                }
            } catch (error) {
                console.error('Error loading admin products:', error);
                adminProductTableBody.innerHTML = `<tr><td colspan="6" class="error-message">Network error loading products.</td></tr>`;
            }
        }

        // ‡πÇ‡∏´‡∏•‡∏î‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Admin
        async function loadAdminOrders() {
            const adminOrderTableBody = document.getElementById('adminOrderTableBody');
            adminOrderTableBody.innerHTML = '<tr><td colspan="7" style="text-align: center;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠...</td></tr>';
            document.getElementById('noAdminOrdersMessage').style.display = 'none';

            try {
                const response = await fetch(`${API_URL}?action=getOrders`);
                const data = await response.json();

                adminOrderTableBody.innerHTML = '';

                if (data.success && data.orders.length > 0) {
                    // orders = data.orders; // Store orders globally if needed
                    data.orders.forEach(order => {
                        let productSummary = '';
                        if (Array.isArray(order.cartitemsjson)) {
                            productSummary = order.cartitemsjson.map(item => `${item.name} (x${item.quantity})`).join(', ');
                        } else {
                            productSummary = 'N/A'; // ‡∏Å‡∏£‡∏ì‡∏µ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ parse ‡πÑ‡∏î‡πâ
                        }

                        const row = adminOrderTableBody.insertRow();
                        row.innerHTML = `
                            <td>${order.orderid}</td>
                            <td>${order.customername}</td>
                            <td>${productSummary}</td>
                            <td>‡∏ø${parseFloat(order.total).toLocaleString('th-TH', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</td>
                            <td style="color: ${getOrderStatusColor(order.status)};"><strong>${order.status}</strong></td>
                            <td>${order.date}</td>
                            <td class="admin-actions">
                                <select onchange="updateOrderStatus('${order.orderid}', this.value)">
                                    <option value="‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô" ${order.status === '‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô' ? 'selected' : ''}>‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</option>
                                    <option value="‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß" ${order.status === '‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß' ? 'selected' : ''}>‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß</option>
                                    <option value="‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏à‡∏±‡∏î‡∏™‡πà‡∏á" ${order.status === '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏à‡∏±‡∏î‡∏™‡πà‡∏á' ? 'selected' : ''}>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏à‡∏±‡∏î‡∏™‡πà‡∏á</option>
                                    <option value="‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à" ${order.status === '‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à' ? 'selected' : ''}>‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</option>
                                    <option value="‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å" ${order.status === '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å' ? 'selected' : ''}>‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</option>
                                </select>
                            </td>
                        `;
                    });
                } else if (data.success && data.orders.length === 0) {
                     document.getElementById('noAdminOrdersMessage').style.display = 'block';
                }
                else {
                    adminOrderTableBody.innerHTML = `<tr><td colspan="7" class="error-message">Error: ${data.error}</td></tr>`;
                }
            } catch (error) {
                console.error('Error loading admin orders:', error);
                adminOrderTableBody.innerHTML = `<tr><td colspan="7" class="error-message">Network error loading orders.</td></tr>`;
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏™‡∏µ‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ Order
        function getOrderStatusColor(status) {
            switch (status) {
                case '‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô': return '#f39c12';
                case '‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß': return '#27ae60';
                case '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏à‡∏±‡∏î‡∏™‡πà‡∏á': return '#3498db';
                case '‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à': return '#2ecc71';
                case '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å': return '#e74c3c';
                default: return '#333';
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
        function showAddProductForm() {
            document.getElementById('addProductForm').style.display = 'block';
            document.getElementById('productEntryForm').reset();
            document.getElementById('productId').value = '';
            document.getElementById('submitProductBtn').innerText = '‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤';
            document.getElementById('addProductForm').querySelector('h3').innerText = '‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà';
            document.getElementById('productFormMessage').innerHTML = '';
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
        function editProduct(productId) {
            const productToEdit = products.find(p => p.id == productId);
            if (productToEdit) {
                document.getElementById('addProductForm').style.display = 'block';
                document.getElementById('addProductForm').querySelector('h3').innerText = '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤';
                document.getElementById('productId').value = productToEdit.id;
                document.getElementById('productName').value = productToEdit.name;
                document.getElementById('productPrice').value = parseFloat(productToEdit.price);
                document.getElementById('productImage').value = productToEdit.image;
                document.getElementById('productSize').value = productToEdit.size;
                document.getElementById('productColor').value = productToEdit.color;
                document.getElementById('productStock').value = parseInt(productToEdit.stock);
                document.getElementById('productDescription').value = productToEdit.description;
                document.getElementById('productCategory').value = productToEdit.category;
                document.getElementById('submitProductBtn').innerText = '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç';
                document.getElementById('productFormMessage').innerHTML = '';
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°/‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
        function cancelProductEdit() {
            document.getElementById('addProductForm').style.display = 'none';
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô Add/Update Product (‡πÉ‡∏ä‡πâ‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô)
        document.getElementById('productEntryForm').addEventListener('submit', async function(event) {
            event.preventDefault();
            showLoading(true, 'productForm');
            document.getElementById('productFormMessage').innerHTML = '';

            const productId = document.getElementById('productId').value;
            const isEditing = !!productId;
            const action = isEditing ? 'updateProduct' : 'addProduct';

            const params = new URLSearchParams();
            params.append('action', action);
            if (isEditing) {
                params.append('id', productId);
            }
            params.append('name', document.getElementById('productName').value);
            params.append('price', document.getElementById('productPrice').value);
            params.append('image', document.getElementById('productImage').value);
            params.append('size', document.getElementById('productSize').value);
            params.append('color', document.getElementById('productColor').value);
            params.append('stock', document.getElementById('productStock').value);
            params.append('description', document.getElementById('productDescription').value);
            params.append('category', document.getElementById('productCategory').value);

            try {
                const response = await fetch(`${API_URL}?${params.toString()}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    body: params.toString()
                });
                const data = await response.json();

                if (data.success) {
                    displayMessage('success', data.message, 'productFormMessage');
                    document.getElementById('productEntryForm').reset();
                    document.getElementById('addProductForm').style.display = 'none';
                    loadAdminProducts(); // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Admin
                    loadProducts('All'); // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
                    loadCategories(); // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà
                } else {
                    displayMessage('error', data.error, 'productFormMessage');
                }
            }
            catch (error) {
                console.error('Product action error:', error);
                displayMessage('error', '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡πÑ‡∏î‡πâ. ‡πÇ‡∏õ‡∏£‡∏î‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á.', 'productFormMessage');
            } finally {
                showLoading(false, 'productForm');
            }
        });

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏•‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
        async function deleteProduct(productId) {
            if (!confirm(`‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ID: ${productId}?`)) {
                return;
            }

            const params = new URLSearchParams();
            params.append('action', 'deleteProduct');
            params.append('id', productId);

            try {
                const response = await fetch(`${API_URL}?${params.toString()}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    body: params.toString()
                });
                const data = await response.json();

                if (data.success) {
                    alert('‡∏•‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
                    loadAdminProducts();
                    loadProducts('All');
                    loadCategories();
                } else {
                    alert(`‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö: ${data.error}`);
                }
            } catch (error) {
                console.error('Delete product error:', error);
                alert('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡πÑ‡∏î‡πâ. ‡πÇ‡∏õ‡∏£‡∏î‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á.');
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Admin)
        async function updateOrderStatus(orderId, status) {
            if (!confirm(`‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ Order ID: ${orderId} ‡πÄ‡∏õ‡πá‡∏ô "${status}"?`)) {
                return;
            }

            const params = new URLSearchParams();
            params.append('action', 'updateOrderStatus');
            params.append('orderId', orderId);
            params.append('status', status);

            try {
                const response = await fetch(`${API_URL}?${params.toString()}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    body: params.toString()
                });
                const data = await response.json();

                if (data.success) {
                    alert('‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
                    loadAdminOrders();
                } else {
                    alert(`‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ${data.error}`);
                }
            } catch (error) {
                console.error('Update order status error:', error);
                alert('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡πÑ‡∏î‡πâ. ‡πÇ‡∏õ‡∏£‡∏î‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á.');
            }
        }
    </script>
</body>
</html>
