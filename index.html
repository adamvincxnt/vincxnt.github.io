<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‚ö° VINCXNT - ‡∏£‡πâ‡∏≤‡∏ô‡∏Ç‡∏≤‡∏¢‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js"></script>
    <style>
        body { font-family: 'Arial', sans-serif; }
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; }
        .modal-content { background: white; margin: 10% auto; padding: 20px; width: 90%; max-width: 500px; border-radius: 8px; }
        .cart-count { position: absolute; top: -10px; right: -10px; background: red; color: white; border-radius: 50%; padding: 2px 6px; font-size: 12px; }
        .loading { text-align: center; padding: 20px; }
        .error { color: red; text-align: center; padding: 10px; }
    </style>
</head>
<body class="bg-gray-100">
    <!-- Firebase Configuration -->
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyB9hhpYYEVe9KzRxS7KclGZwQn82QZIaMs",
            authDomain: "primeval-pixel-270616.firebaseapp.com",
            projectId: "primeval-pixel-270616",
            storageBucket: "primeval-pixel-270616.appspot.com",
            messagingSenderId: "611613434861",
            appId: "1:611613434861:web:e18b6fa7f50f66e8097de4",
            measurementId: "G-Y6SSJM41F9"
        };

        let db, auth;
        if (typeof firebase === 'undefined') {
            document.getElementById('product-list').innerHTML = '<p class="error">‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î Firebase SDK ‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏≠‡∏¥‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ï</p>';
        } else {
            try {
                firebase.initializeApp(firebaseConfig);
                db = firebase.firestore();
                auth = firebase.auth();
            } catch (error) {
                document.getElementById('product-list').innerHTML = `<p class="error">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô Firebase: ${error.message}</p>`;
            }
        }
    </script>

    <!-- Header -->
    <header class="bg-black text-white p-4">
        <div class="container mx-auto flex justify-between items-center">
            <h1 class="text-2xl font-bold">‚ö° VINCXNT</h1>
            <nav>
                <a href="#shop" class="mx-2">üõçÔ∏è ‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤</a>
                <a href="#admin" class="mx-2">‚öôÔ∏è ‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏•‡∏±‡∏á‡∏ö‡πâ‡∏≤‡∏ô</a>
            </nav>
            <div class="relative">
                <button onclick="openCart()" class="text-xl">üõí</button>
                <span id="cart-count" class="cart-count">0</span>
            </div>
        </div>
    </header>

    <!-- Shop Section -->
    <section id="shop" class="container mx-auto p-4">
        <h2 class="text-3xl font-bold text-center mb-4">üî• STREETWEAR COLLECTION</h2>
        <p class="text-center mb-6">AUTHENTIC URBAN FASHION ‚Ä¢ PREMIUM QUALITY ‚Ä¢ LIMITED EDITION</p>
        <div id="product-list" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4">
            <div class="loading">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>
        </div>
    </section>

    <!-- Admin Section -->
    <section id="admin" class="container mx-auto p-4 hidden">
        <h2 class="text-3xl font-bold mb-4">üìä ADMIN DASHBOARD</h2>
        
        <!-- Admin Login -->
        <div id="admin-login" class="bg-white p-6 rounded shadow">
            <h3 class="text-xl mb-4">üîê ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô</h3>
            <div class="mb-4">
                <label>‡∏≠‡∏µ‡πÄ‡∏°‡∏•:</label>
                <input id="admin-email" type="email" class="border p-2 w-full" placeholder="admin@vincxnt.com">
            </div>
            <div class="mb-4">
                <label>‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô:</label>
                <input id="admin-password" type="password" class="border p-2 w-full" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô">
            </div>
            <button onclick="adminLogin()" class="bg-blue-500 text-white p-2 rounded w-full">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
            <p class="mt-2 text-sm">‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: admin@vincxnt.com / password123</p>
        </div>

        <!-- Admin Dashboard -->
        <div id="admin-dashboard" class="hidden">
            <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                <div class="bg-white p-4 rounded shadow text-center">
                    <p id="total-orders">0</p>
                    <p>‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                </div>
                <div class="bg-white p-4 rounded shadow text-center">
                    <p id="total-sales">0</p>
                    <p>‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏ß‡∏° (‡∏ö‡∏≤‡∏ó)</p>
                </div>
                <div class="bg-white p-4 rounded shadow text-center">
                    <p id="total-products">0</p>
                    <p>‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                </div>
                <div class="bg-white p-4 rounded shadow text-center">
                    <p id="pending-payments">0</p>
                    <p>‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</p>
                </div>
            </div>

            <!-- Add Product -->
            <h3 class="text-xl mb-4">üìã ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h3>
            <form id="add-product-form" class="bg-white p-6 rounded shadow mb-6">
                <input type="text" name="name" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤" class="border p-2 w-full mb-2" required>
                <input type="number" name="price" placeholder="‡∏£‡∏≤‡∏Ñ‡∏≤ (‡∏ö‡∏≤‡∏ó)" class="border p-2 w-full mb-2" required>
                <input type="text" name="image" placeholder="URL ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û (‡πÄ‡∏ä‡πà‡∏ô Imgur)" class="border p-2 w-full mb-2" required>
                <button type="submit" class="bg-green-500 text-white p-2 rounded w-full">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</button>
            </form>

            <!-- Manage Orders -->
            <h3 class="text-xl mb-4">üìã ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</h3>
            <table class="w-full bg-white rounded shadow">
                <thead>
                    <tr class="bg-gray-200">
                        <th class="p-2">‡∏£‡∏´‡∏±‡∏™‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</th>
                        <th class="p-2">‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</th>
                        <th class="p-2">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</th>
                        <th class="p-2">‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°</th>
                        <th class="p-2">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                        <th class="p-2">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                    </tr>
                </thead>
                <tbody id="order-list"></tbody>
            </table>
            <button onclick="adminLogout()" class="bg-red-500 text-white p-2 rounded mt-4">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
        </div>
    </section>

    <!-- Cart Modal -->
    <div id="cart-modal" class="modal">
        <div class="modal-content">
            <span onclick="closeCart()" class="float-right text-xl cursor-pointer">√ó</span>
            <h2 class="text-2xl mb-4">üõí ‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h2>
            <div id="cart-items" class="mb-4"></div>
            <p class="text-lg font-bold">‡∏£‡∏ß‡∏°: <span id="cart-total">0</span> ‡∏ö‡∏≤‡∏ó</p>
            <button onclick="openOrderForm()" class="bg-blue-500 text-white p-2 rounded w-full mt-4">‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏•‡∏¢</button>
        </div>
    </div>

    <!-- Order Form Modal -->
    <div id="order-form-modal" class="modal">
        <div class="modal-content">
            <span onclick="closeOrderForm()" class="float-right text-xl cursor-pointer">√ó</span>
            <h2 class="text-2xl mb-4">üìù ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</h2>
            <form id="order-form">
                <div class="mb-4">
                    <label>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•:</label>
                    <input type="text" name="customerName" class="border p-2 w-full" required>
                </div>
                <div class="mb-4">
                    <label>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£:</label>
                    <input type="tel" name="phone" class="border p-2 w-full" required>
                </div>
                <div class="mb-4">
                    <label>‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏±‡∏î‡∏™‡πà‡∏á:</label>
                    <textarea name="address" class="border p-2 w-full" required></textarea>
                </div>
                <div class="mb-4">
                    <label>‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô:</label>
                    <select name="paymentMethod" class="border p-2 w-full" onchange="togglePaymentMethod(this)">
                        <option value="qr">QR Code</option>
                        <option value="transfer">‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</option>
                        <option value="cod">‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á</option>
                    </select>
                </div>
                <button type="submit" class="bg-green-500 text-white p-2 rounded w-full">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</button>
            </form>
        </div>
    </div>

    <!-- Payment Modal -->
    <div id="payment-modal" class="modal">
        <div class="modal-content">
            <span onclick="closePayment()" class="float-right text-xl cursor-pointer">√ó</span>
            <h2 class="text-2xl mb-4">üí≥ ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</h2>
            <div id="payment-details" class="text-center">
                <p class="mb-4">üì± ‡∏™‡πÅ‡∏Å‡∏ô QR Code ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</p>
                <p class="mb-4">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô: <span id="payment-amount">0</span> ‡∏ö‡∏≤‡∏ó</p>
                <img id="qr-code" src="YOUR_QR_CODE_URL" alt="QR Code" class="mx-auto mb-4" style="max-width: 200px;">
                <p class="text-sm">*QR Code ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</p>
            </div>
            <button onclick="confirmPayment()" class="bg-green-500 text-white p-2 rounded w-full mt-4">‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</button>
        </div>
    </div>

    <script>
        let cart = [];
        let isAdmin = false;

        // Firebase: Load Products
        async function loadProducts() {
            const productList = document.getElementById('product-list');
            if (!db) {
                productList.innerHTML = '<p class="error">‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Firebase Configuration</p>';
                return;
            }
            try {
                productList.innerHTML = '<div class="loading">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>';
                const snapshot = await db.collection('products').get();
                productList.innerHTML = '';
                if (snapshot.empty) {
                    productList.innerHTML = '<p class="error">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô‡∏£‡πâ‡∏≤‡∏ô</p>';
                    return;
                }
                let totalProducts = 0;
                snapshot.forEach(doc => {
                    const product = { id: doc.id, ...doc.data() };
                    totalProducts++;
                    productList.innerHTML += `
                        <div class="bg-white p-4 rounded shadow">
                            <img src="${product.image}" alt="${product.name}" class="w-full h-48 object-cover mb-2" onerror="this.src='https://via.placeholder.com/150';">
                            <h3 class="text-lg font-bold">${product.name}</h3>
                            <p>${product.price} ‡∏ö‡∏≤‡∏ó</p>
                            <button onclick="addToCart('${product.id}', '${product.name}', ${product.price}, '${product.image}')" class="bg-green-500 text-white p-2 rounded w-full mt-2">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤</button>
                        </div>
                    `;
                });
                document.getElementById('total-products').innerText = totalProducts;
            } catch (error) {
                productList.innerHTML = `<p class="error">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤: ${error.message}</p>`;
            }
        }

        // Cart Functions
        function addToCart(id, name, price, image) {
            cart.push({ id, name, price, image });
            updateCart();
        }

        function updateCart() {
            const cartItems = document.getElementById('cart-items');
            const cartCount = document.getElementById('cart-count');
            const cartTotal = document.getElementById('cart-total');
            cartItems.innerHTML = '';
            let total = 0;
            cart.forEach((item, index) => {
                total += item.price;
                cartItems.innerHTML += `
                    <div class="flex justify-between mb-2">
                        <span>${item.name} - ${item.price} ‡∏ö‡∏≤‡∏ó</span>
                        <button onclick="removeFromCart(${index})" class="bg-red-500 text-white p-1 rounded">‡∏•‡∏ö</button>
                    </div>
                `;
            });
            cartCount.innerText = cart.length;
            cartTotal.innerText = total;
            document.getElementById('payment-amount').innerText = total;
        }

        function removeFromCart(index) {
            cart.splice(index, 1);
            updateCart();
        }

        function openCart() {
            if (cart.length === 0) {
                alert('‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏õ‡∏•‡πà‡∏≤!');
                return;
            }
            document.getElementById('cart-modal').style.display = 'block';
        }

        function closeCart() {
            document.getElementById('cart-modal').style.display = 'none';
        }

        // Order Form
        function openOrderForm() {
            if (cart.length === 0) {
                alert('‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏õ‡∏•‡πà‡∏≤!');
                return;
            }
            closeCart();
            document.getElementById('order-form-modal').style.display = 'block';
        }

        function closeOrderForm() {
            document.getElementById('order-form-modal').style.display = 'none';
        }

        // Payment
        function togglePaymentMethod(select) {
            const paymentModal = document.getElementById('payment-details');
            const total = document.getElementById('cart-total').innerText;
            if (select.value === 'qr') {
                paymentModal.innerHTML = `
                    <p class="mb-4">üì± ‡∏™‡πÅ‡∏Å‡∏ô QR Code ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</p>
                    <p class="mb-4">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô: <span id="payment-amount">${total}</span> ‡∏ö‡∏≤‡∏ó</p>
                    <img id="qr-code" src="YOUR_QR_CODE_URL" alt="QR Code" class="mx-auto mb-4" style="max-width: 200px;" onerror="this.src='https://via.placeholder.com/150';">
                    <p class="text-sm">*QR Code ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</p>
                `;
            } else if (select.value === 'transfer') {
                paymentModal.innerHTML = `<p class="mb-4">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ: ‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£ XXX ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà XXX-XXX-XXX</p>`;
            } else {
                paymentModal.innerHTML = `<p class="mb-4">‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</p>`;
            }
        }

        function openPayment() {
            closeOrderForm();
            document.getElementById('payment-modal').style.display = 'block';
        }

        function closePayment() {
            document.getElementById('payment-modal').style.display = 'none';
        }

        async function confirmPayment() {
            if (!db) {
                alert('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠');
                return;
            }
            try {
                const order = {
                    customerName: document.querySelector('#order-form [name="customerName"]').value,
                    phone: document.querySelector('#order-form [name="phone"]').value,
                    address: document.querySelector('#order-form [name="address"]').value,
                    paymentMethod: document.querySelector('#order-form [name="paymentMethod"]').value,
                    items: cart,
                    total: parseFloat(document.getElementById('cart-total').innerText),
                    status: 'pending',
                    createdAt: new Date()
                };
                await db.collection('orders').add(order);
                alert('‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
                cart = [];
                updateCart();
                closePayment();
                if (isAdmin) loadOrders();
            } catch (error) {
                alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠: ' + error.message);
            }
        }

        // Admin Functions
        async function adminLogin() {
            if (!auth) {
                alert('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Firebase Configuration');
                return;
            }
            const email = document.getElementById('admin-email').value;
            const password = document.getElementById('admin-password').value;
            try {
                await auth.signInWithEmailAndPassword(email, password);
                isAdmin = true;
                document.getElementById('admin-login').classList.add('hidden');
                document.getElementById('admin-dashboard').classList.remove('hidden');
                document.getElementById('admin').classList.remove('hidden');
                document.getElementById('shop').classList.add('hidden');
                loadOrders();
            } catch (error) {
                alert('‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ú‡∏¥‡∏î: ' + error.message);
            }
        }

        async function adminLogout() {
            if (!auth) {
                alert('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Firebase Configuration');
                return;
            }
            try {
                await auth.signOut();
                isAdmin = false;
                document.getElementById('admin-login').classList.remove('hidden');
                document.getElementById('admin-dashboard').classList.add('hidden');
                document.getElementById('admin').classList.add('hidden');
                document.getElementById('shop').classList.remove('hidden');
            } catch (error) {
                alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö: ' + error.message);
            }
        }

        // Load Orders
        async function loadOrders() {
            const orderList = document.getElementById('order-list');
            if (!db) {
                orderList.innerHTML = '<tr><td colspan="6" class="p-2 error">‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Firebase Configuration</td></tr>';
                return;
            }
            try {
                orderList.innerHTML = '<div class="loading">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>';
                const snapshot = await db.collection('orders').get();
                orderList.innerHTML = '';
                if (snapshot.empty) {
                    orderList.innerHTML = '<tr><td colspan="6" class="p-2 text-center">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</td></tr>';
                    return;
                }
                let totalOrders = 0;
                let totalSales = 0;
                let pendingPayments = 0;
                snapshot.forEach(doc => {
                    const order = { id: doc.id, ...doc.data() };
                    totalOrders++;
                    totalSales += order.total;
                    if (order.status === 'pending') pendingPayments++;
                    orderList.innerHTML += `
                        <tr>
                            <td class="p-2">${order.id}</td>
                            <td class="p-2">${order.customerName}</td>
                            <td class="p-2">${order.items.map(item => item.name).join(', ')}</td>
                            <td class="p-2">${order.total} ‡∏ö‡∏≤‡∏ó</td>
                            <td class="p-2">${order.status}</td>
                            <td class="p-2">
                                <button onclick="updateOrderStatus('${order.id}', 'completed')" class="bg-green-500 text-white p-1 rounded">‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</button>
                                <button onclick="updateOrderStatus('${order.id}', 'cancelled')" class="bg-red-500 text-white p-1 rounded">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                            </td>
                        </tr>
                    `;
                });
                document.getElementById('total-orders').innerText = totalOrders;
                document.getElementById('total-sales').innerText = totalSales;
                document.getElementById('pending-payments').innerText = pendingPayments;
            } catch (error) {
                orderList.innerHTML = `<tr><td colspan="6" class="p-2 error">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠: ${error.message}</td></tr>`;
            }
        }

        async function updateOrderStatus(orderId, status) {
            if (!db) {
                alert('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Firebase Configuration');
                return;
            }
            try {
                await db.collection('orders').doc(orderId).update({ status });
                loadOrders();
            } catch (error) {
                alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ' + error.message);
            }
        }

        // Add Product
        document.getElementById('add-product-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            if (!db) {
                alert('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Firebase Configuration');
                return;
            }
            try {
                const product = {
                    name: e.target.name.value,
                    price: parseFloat(e.target.price.value),
                    image: e.target.image.value
                };
                await db.collection('products').add(product);
                alert('‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
                e.target.reset();
                loadProducts();
            } catch (error) {
                alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤: ' + error.message);
            }
        });

        // Order Form Submission
        document.getElementById('order-form').addEventListener('submit', (e) => {
            e.preventDefault();
            openPayment();
        });

        // Initialize
        if (db) {
            loadProducts();
            auth.onAuthStateChanged((user) => {
                if (user) {
                    isAdmin = true;
                    document.getElementById('admin-login').classList.add('hidden');
                    document.getElementById('admin-dashboard').classList.remove('hidden');
                    document.getElementById('admin').classList.remove('hidden');
                    document.getElementById('shop').classList.add('hidden');
                    loadOrders();
                }
            });
        } else {
            document.getElementById('product-list').innerHTML = '<p class="error">‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Firebase Configuration</p>';
        }
    </script>
</body>
</html>
